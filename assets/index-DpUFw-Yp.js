var me=t=>{throw TypeError(t)};var te=(t,e,s)=>e.has(t)||me("Cannot "+s);var i=(t,e,s)=>(te(t,e,"read from private field"),s?s.call(t):e.get(t)),b=(t,e,s)=>e.has(t)?me("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,s),p=(t,e,s,r)=>(te(t,e,"write to private field"),r?r.call(t,s):e.set(t,s),s),y=(t,e,s)=>(te(t,e,"access private method"),s);import{S as Qe,p as ye,r as I,s as se,a as q,n as ie,i as re,b as ge,t as je,f as Fe,c as ke,d as be,e as Ee,g as T,h as Me,u as _e,R as k,j as v,B as ve}from"./index-CBFSyAgf.js";var w,n,J,x,L,$,M,_,X,W,z,N,H,D,G,c,K,ne,ae,oe,he,ce,le,ue,Oe,Se,De=(Se=class extends Qe{constructor(e,s){super();b(this,c);b(this,w);b(this,n);b(this,J);b(this,x);b(this,L);b(this,$);b(this,M);b(this,_);b(this,X);b(this,W);b(this,z);b(this,N);b(this,H);b(this,D);b(this,G,new Set);this.options=s,p(this,w,e),p(this,_,null),p(this,M,ye()),this.options.experimental_prefetchInRender||i(this,M).reject(new Error("experimental_prefetchInRender feature flag is not enabled")),this.bindMethods(),this.setOptions(s)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(i(this,n).addObserver(this),Re(i(this,n),this.options)?y(this,c,K).call(this):this.updateResult(),y(this,c,he).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return fe(i(this,n),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return fe(i(this,n),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,y(this,c,ce).call(this),y(this,c,le).call(this),i(this,n).removeObserver(this)}setOptions(e){const s=this.options,r=i(this,n);if(this.options=i(this,w).defaultQueryOptions(e),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof I(this.options.enabled,i(this,n))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");y(this,c,ue).call(this),i(this,n).setOptions(this.options),s._defaulted&&!se(this.options,s)&&i(this,w).getQueryCache().notify({type:"observerOptionsUpdated",query:i(this,n),observer:this});const o=this.hasListeners();o&&xe(i(this,n),r,this.options,s)&&y(this,c,K).call(this),this.updateResult(),o&&(i(this,n)!==r||I(this.options.enabled,i(this,n))!==I(s.enabled,i(this,n))||q(this.options.staleTime,i(this,n))!==q(s.staleTime,i(this,n)))&&y(this,c,ne).call(this);const h=y(this,c,ae).call(this);o&&(i(this,n)!==r||I(this.options.enabled,i(this,n))!==I(s.enabled,i(this,n))||h!==i(this,D))&&y(this,c,oe).call(this,h)}getOptimisticResult(e){const s=i(this,w).getQueryCache().build(i(this,w),e),r=this.createResult(s,e);return Pe(this,r)&&(p(this,x,r),p(this,$,this.options),p(this,L,i(this,n).state)),r}getCurrentResult(){return i(this,x)}trackResult(e,s){return new Proxy(e,{get:(r,o)=>(this.trackProp(o),s==null||s(o),Reflect.get(r,o))})}trackProp(e){i(this,G).add(e)}getCurrentQuery(){return i(this,n)}refetch({...e}={}){return this.fetch({...e})}fetchOptimistic(e){const s=i(this,w).defaultQueryOptions(e),r=i(this,w).getQueryCache().build(i(this,w),s);return r.fetch().then(()=>this.createResult(r,s))}fetch(e){return y(this,c,K).call(this,{...e,cancelRefetch:e.cancelRefetch??!0}).then(()=>(this.updateResult(),i(this,x)))}createResult(e,s){var pe;const r=i(this,n),o=this.options,h=i(this,x),a=i(this,L),l=i(this,$),g=e!==r?e.state:i(this,J),{state:m}=e;let f={...m},j=!1,d;if(s._optimisticResults){const O=this.hasListeners(),Y=!O&&Re(e,s),B=O&&xe(e,r,s,o);(Y||B)&&(f={...f,...ke(m.data,e.options)}),s._optimisticResults==="isRestoring"&&(f.fetchStatus="idle")}let{error:U,errorUpdatedAt:F,status:R}=f;d=f.data;let Q=!1;if(s.placeholderData!==void 0&&d===void 0&&R==="pending"){let O;h!=null&&h.isPlaceholderData&&s.placeholderData===(l==null?void 0:l.placeholderData)?(O=h.data,Q=!0):O=typeof s.placeholderData=="function"?s.placeholderData((pe=i(this,z))==null?void 0:pe.state.data,i(this,z)):s.placeholderData,O!==void 0&&(R="success",d=be(h==null?void 0:h.data,O,s),j=!0)}if(s.select&&d!==void 0&&!Q)if(h&&d===(a==null?void 0:a.data)&&s.select===i(this,X))d=i(this,W);else try{p(this,X,s.select),d=s.select(d),d=be(h==null?void 0:h.data,d,s),p(this,W,d),p(this,_,null)}catch(O){p(this,_,O)}i(this,_)&&(U=i(this,_),d=i(this,W),F=Date.now(),R="error");const P=f.fetchStatus==="fetching",C=R==="pending",S=R==="error",V=C&&P,A=d!==void 0,E={status:R,fetchStatus:f.fetchStatus,isPending:C,isSuccess:R==="success",isError:S,isInitialLoading:V,isLoading:V,data:d,dataUpdatedAt:f.dataUpdatedAt,error:U,errorUpdatedAt:F,failureCount:f.fetchFailureCount,failureReason:f.fetchFailureReason,errorUpdateCount:f.errorUpdateCount,isFetched:f.dataUpdateCount>0||f.errorUpdateCount>0,isFetchedAfterMount:f.dataUpdateCount>g.dataUpdateCount||f.errorUpdateCount>g.errorUpdateCount,isFetching:P,isRefetching:P&&!C,isLoadingError:S&&!A,isPaused:f.fetchStatus==="paused",isPlaceholderData:j,isRefetchError:S&&A,isStale:de(e,s),refetch:this.refetch,promise:i(this,M)};if(this.options.experimental_prefetchInRender){const O=Z=>{E.status==="error"?Z.reject(E.error):E.data!==void 0&&Z.resolve(E.data)},Y=()=>{const Z=p(this,M,E.promise=ye());O(Z)},B=i(this,M);switch(B.status){case"pending":e.queryHash===r.queryHash&&O(B);break;case"fulfilled":(E.status==="error"||E.data!==B.value)&&Y();break;case"rejected":(E.status!=="error"||E.error!==B.reason)&&Y();break}}return E}updateResult(){const e=i(this,x),s=this.createResult(i(this,n),this.options);if(p(this,L,i(this,n).state),p(this,$,this.options),i(this,L).data!==void 0&&p(this,z,i(this,n)),se(s,e))return;p(this,x,s);const r=()=>{if(!e)return!0;const{notifyOnChangeProps:o}=this.options,h=typeof o=="function"?o():o;if(h==="all"||!h&&!i(this,G).size)return!0;const a=new Set(h??i(this,G));return this.options.throwOnError&&a.add("error"),Object.keys(i(this,x)).some(l=>{const u=l;return i(this,x)[u]!==e[u]&&a.has(u)})};y(this,c,Oe).call(this,{listeners:r()})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&y(this,c,he).call(this)}},w=new WeakMap,n=new WeakMap,J=new WeakMap,x=new WeakMap,L=new WeakMap,$=new WeakMap,M=new WeakMap,_=new WeakMap,X=new WeakMap,W=new WeakMap,z=new WeakMap,N=new WeakMap,H=new WeakMap,D=new WeakMap,G=new WeakMap,c=new WeakSet,K=function(e){y(this,c,ue).call(this);let s=i(this,n).fetch(this.options,e);return e!=null&&e.throwOnError||(s=s.catch(ie)),s},ne=function(){y(this,c,ce).call(this);const e=q(this.options.staleTime,i(this,n));if(re||i(this,x).isStale||!ge(e))return;const r=je(i(this,x).dataUpdatedAt,e)+1;p(this,N,setTimeout(()=>{i(this,x).isStale||this.updateResult()},r))},ae=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(i(this,n)):this.options.refetchInterval)??!1},oe=function(e){y(this,c,le).call(this),p(this,D,e),!(re||I(this.options.enabled,i(this,n))===!1||!ge(i(this,D))||i(this,D)===0)&&p(this,H,setInterval(()=>{(this.options.refetchIntervalInBackground||Fe.isFocused())&&y(this,c,K).call(this)},i(this,D)))},he=function(){y(this,c,ne).call(this),y(this,c,oe).call(this,y(this,c,ae).call(this))},ce=function(){i(this,N)&&(clearTimeout(i(this,N)),p(this,N,void 0))},le=function(){i(this,H)&&(clearInterval(i(this,H)),p(this,H,void 0))},ue=function(){const e=i(this,w).getQueryCache().build(i(this,w),this.options);if(e===i(this,n))return;const s=i(this,n);p(this,n,e),p(this,J,e.state),this.hasListeners()&&(s==null||s.removeObserver(this),e.addObserver(this))},Oe=function(e){Ee.batch(()=>{e.listeners&&this.listeners.forEach(s=>{s(i(this,x))}),i(this,w).getQueryCache().notify({query:i(this,n),type:"observerResultsUpdated"})})},Se);function Ue(t,e){return I(e.enabled,t)!==!1&&t.state.data===void 0&&!(t.state.status==="error"&&e.retryOnMount===!1)}function Re(t,e){return Ue(t,e)||t.state.data!==void 0&&fe(t,e,e.refetchOnMount)}function fe(t,e,s){if(I(e.enabled,t)!==!1&&q(e.staleTime,t)!=="static"){const r=typeof s=="function"?s(t):s;return r==="always"||r!==!1&&de(t,e)}return!1}function xe(t,e,s,r){return(t!==e||I(r.enabled,t)===!1)&&(!s.suspense||t.state.status!=="error")&&de(t,s)}function de(t,e){return I(e.enabled,t)!==!1&&t.isStaleByTime(q(e.staleTime,t))}function Pe(t,e){return!se(t.getCurrentResult(),e)}var Te=T.createContext(!1),Le=()=>T.useContext(Te);Te.Provider;function Ne(){let t=!1;return{clearReset:()=>{t=!1},reset:()=>{t=!0},isReset:()=>t}}var He=T.createContext(Ne()),Ae=()=>T.useContext(He),Be=(t,e)=>{(t.suspense||t.throwOnError||t.experimental_prefetchInRender)&&(e.isReset()||(t.retryOnMount=!1))},$e=t=>{T.useEffect(()=>{t.clearReset()},[t])},We=({result:t,errorResetBoundary:e,throwOnError:s,query:r,suspense:o})=>t.isError&&!e.isReset()&&!t.isFetching&&r&&(o&&t.data===void 0||Me(s,[t.error,r])),ze=t=>{if(t.suspense){const e=r=>r==="static"?r:Math.max(r??1e3,1e3),s=t.staleTime;t.staleTime=typeof s=="function"?(...r)=>e(s(...r)):e(s),typeof t.gcTime=="number"&&(t.gcTime=Math.max(t.gcTime,1e3))}},Ge=(t,e)=>t.isLoading&&t.isFetching&&!e,Ve=(t,e)=>(t==null?void 0:t.suspense)&&e.isPending,we=(t,e,s)=>e.fetchOptimistic(t).catch(()=>{s.clearReset()});function Ke(t,e,s){var f,j,d,U,F;const r=Le(),o=Ae(),h=_e(),a=h.defaultQueryOptions(t);(j=(f=h.getDefaultOptions().queries)==null?void 0:f._experimental_beforeQuery)==null||j.call(f,a),a._optimisticResults=r?"isRestoring":"optimistic",ze(a),Be(a,o),$e(o);const l=!h.getQueryCache().get(a.queryHash),[u]=T.useState(()=>new e(h,a)),g=u.getOptimisticResult(a),m=!r&&t.subscribed!==!1;if(T.useSyncExternalStore(T.useCallback(R=>{const Q=m?u.subscribe(Ee.batchCalls(R)):ie;return u.updateResult(),Q},[u,m]),()=>u.getCurrentResult(),()=>u.getCurrentResult()),T.useEffect(()=>{u.setOptions(a)},[a,u]),Ve(a,g))throw we(a,u,o);if(We({result:g,errorResetBoundary:o,throwOnError:a.throwOnError,query:h.getQueryCache().get(a.queryHash),suspense:a.suspense}))throw g.error;if((U=(d=h.getDefaultOptions().queries)==null?void 0:d._experimental_afterQuery)==null||U.call(d,a,g),a.experimental_prefetchInRender&&!re&&Ge(g,r)){const R=l?we(a,u,o):(F=h.getQueryCache().get(a.queryHash))==null?void 0:F.promise;R==null||R.catch(ie).finally(()=>{u.updateResult()})}return a.notifyOnChangeProps?g:u.trackResult(g)}function qe(t,e){return Ke(t,De)}const Je="https://api.imgflip.com/";async function Xe({signal:t}){const e=Math.random()*7e3+4e3;await new Promise(o=>setTimeout(o,e));const s=await fetch(Je+"/get_memes",{signal:t});if(!s.ok)throw new Error(`HTTP error! status: ${s.status}`);return(await s.json()).data}const Ye=k.createContext({}),Ie=!0;function Ze({baseColor:t,highlightColor:e,width:s,height:r,borderRadius:o,circle:h,direction:a,duration:l,enableAnimation:u=Ie,customHighlightBackground:g}){const m={};return a==="rtl"&&(m["--animation-direction"]="reverse"),typeof l=="number"&&(m["--animation-duration"]=`${l}s`),u||(m["--pseudo-element-display"]="none"),(typeof s=="string"||typeof s=="number")&&(m.width=s),(typeof r=="string"||typeof r=="number")&&(m.height=r),(typeof o=="string"||typeof o=="number")&&(m.borderRadius=o),h&&(m.borderRadius="50%"),typeof t<"u"&&(m["--base-color"]=t),typeof e<"u"&&(m["--highlight-color"]=e),typeof g=="string"&&(m["--custom-highlight-background"]=g),m}function Ce({count:t=1,wrapper:e,className:s,containerClassName:r,containerTestId:o,circle:h=!1,style:a,...l}){var u,g,m;const f=k.useContext(Ye),j={...l};for(const[C,S]of Object.entries(l))typeof S>"u"&&delete j[C];const d={...f,...j,circle:h},U={...a,...Ze(d)};let F="react-loading-skeleton";s&&(F+=` ${s}`);const R=(u=d.inline)!==null&&u!==void 0?u:!1,Q=[],P=Math.ceil(t);for(let C=0;C<P;C++){let S=U;if(P>t&&C===P-1){const A=(g=S.width)!==null&&g!==void 0?g:"100%",ee=t%1,E=typeof A=="number"?A*ee:`calc(${A} * ${ee})`;S={...S,width:E}}const V=k.createElement("span",{className:F,style:S,key:C},"‌");R?Q.push(V):Q.push(k.createElement(k.Fragment,{key:C},V,k.createElement("br",null)))}return k.createElement("span",{className:r,"data-testid":o,"aria-live":"polite","aria-busy":(m=d.enableAnimation)!==null&&m!==void 0?m:Ie},e?Q.map((C,S)=>k.createElement(e,{key:S},C)):Q)}const et=3e3;function it(){const{isLoading:t,isError:e,isSuccess:s,data:r,refetch:o}=qe({queryKey:["getMeme"],queryFn:Xe}),[h,a]=T.useState(!1);return T.useEffect(()=>{let l=null;return t?l=setTimeout(()=>{a(!0)},et):(a(!1),l&&clearTimeout(l)),()=>{l&&clearTimeout(l)}},[t]),e?v.jsx("div",{className:"w-full h-[calc(100%-30px)] text-black bg-white",children:v.jsxs("div",{className:"py-6",children:[v.jsx("span",{children:"Something's wrong with the connection."}),v.jsx(ve,{onClick:()=>o(),children:"retry"})]})}):t?v.jsxs("div",{className:"w-full h-[calc(100%-30px)] text-black bg-white",children:[v.jsxs("div",{className:"py-6",children:[v.jsx(Ce,{width:500,height:30}),v.jsx(Ce,{width:500,height:300})]}),h&&v.jsx(v.Fragment,{children:v.jsxs("div",{children:[v.jsx("span",{children:"This is getting longer than expected..."}),v.jsx(ve,{onClick:()=>{o(),a(!1)},children:"Try again"})]})})]}):v.jsx("div",{className:"w-full h-[calc(100%-30px)] text-black bg-white overflow-y-scroll",children:s&&r.memes.map(l=>v.jsxs("figure",{children:[v.jsx("figcaption",{className:"py-2",children:l.name}),v.jsx("img",{src:l.url,alt:l.name})]}))})}export{it as default};
